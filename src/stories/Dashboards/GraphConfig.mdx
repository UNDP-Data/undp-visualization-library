import React, { useState } from 'react';
import { Meta, Source } from '@storybook/blocks';
import { GraphSettingsSelector } from '../assets/GraphSettingsSelector';
import multiGraph from '../assets/config/dashboard.json';
import { GraphNames } from '../assets/constants';

<Meta
  title='Dashboard/From JSON Config'
  parameters={{
    layout: 'fullscreen',
    viewMode: 'docs',
    previewTabs: {
      canvas: { hidden: false },
      story: { hidden: false },
    },
    docs: {
      story: {
        inline: false,
        iframeHeight: '100%',
      },
    },
  }}
/>

# Graph Config

You can create three types of visualizations using the following components: `SingleGraphDashboardFromConfig`, `GriddedGraphDashboardFromConfig` and `MultiGraphDashboardFromConfig`
Below are full JSON configuration examples for each type.

```tsx
import { SingleGraphDashboardFromConfig } from '@undp-data/undp-visualization-library';
import '@undp-data/undp-design-system-react/dist/style.css';

function Graph() {
  return (
    <SingleGraphDashboardFromConfig config='/barChart.json' />
  );
}

```

## Single graph config

Below is the full config example for the `SingleGraphDashboardFromConfig`. Select a chart type below to see its full config.

<ConfigFilesDropdown forGriddedGraph={false} />

## Gridded graphs config

Below is the full config example for the `GriddedGraphDashboardFromConfig`. Select a chart type below to see its full config.

<ConfigFilesDropdown forGriddedGraph />

## Dashboard config

Below is the full config example for the `MultiGraphDashboardFromConfig`.

<Source code={JSON.stringify(multiGraph, null, 2)} language='json' />

export const ConfigFilesDropdown = ({forGriddedGraph}) => {

  const [selected, setSelected] = useState('Bar graph');

  return (
    <div style={{ marginTop: '1rem' }}>
      <label htmlFor='chart-select'>
        <strong>Chart Type: </strong>
      </label>
      <select
        id='chart-select'
        value={selected}
        onChange={e => setSelected(e.target.value)}
      >
        {GraphNames
          .map(d => d.name)
          .sort()
          .map(key => (
            <option key={key} value={key}>
              {key}
            </option>
        ))}
      </select>
      <Source
        code={GraphSettingsSelector(selected, false, forGriddedGraph)}
        language='json'
      />
    </div>
  )
}