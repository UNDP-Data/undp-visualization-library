import { Meta } from '@storybook/blocks';

<Meta title="Utilities/Downloads/excelDownload" />

# excelDownload

Downloads CSV data as an Excel file with specified headers and column widths.
 
The function converts JSON data (`csvData`) to an Excel sheet, adds headers, and applies custom column widths.

The resulting file is then downloaded using `file-saver` as an `.xlsx` file.

__For this to work you will have to install `xlsx` package to your project__

```ts
function excelDownload = (
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  csvData: any,
  fileName: string,
  headers: string[],
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  xlsxHeader:  {
    [key: string]: string;
  },
  wscols: {
    wch: number;
  }[],
)
```

## Parameters

- `csvData` - The data to be exported as an Excel sheet, represented as an array of objects.
- `fileName` - The name of the file to be downloaded (without extension).
- `headers` - The headers for the Excel sheet.
- `xlsxHeader` - The header data to be used for the Excel file (should match `headers`).
- `wscols` - The column width configuration, where each item corresponds to a column.

## Example Usage

```js
// Example of how to use the function
const data = [{ name: 'Alice', age: 25 }, { name: 'Bob', age: 30 }];
const headers = ['name', 'age'];
const xlsxHeader = {
  name: "Full Name",
  age: "Age",
};
const columnWidths = [{ wch: 10 }, { wch: 5 }];
excelDownload(data, 'user_data', headers, xlsxHeader, columnWidths);
 